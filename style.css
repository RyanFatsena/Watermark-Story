
/* --- Base Reset & Variables --- */
:root{
  --bg:#f7f9fc;
  --bg-elev:#ffffff;
  --text:#0d1117;
  --muted:#6b7280;
  --border:#e5e7eb;
  --border-strong:#d1d5db;
  --primary:#3b82f6;
  --danger:#ef4444;
  --ring: rgba(59,130,246,.30);
  --shadow:0 10px 30px rgba(2,6,23,.06);
  --radius:14px;
  --space:12px;
  --fs-12:12px;
  --fs-14:14px;
  --fs-16:16px;
  --fs-18:18px;
}
[data-theme="dark"]{
  --bg:#0b1220;
  --bg-elev:#0f172a;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --border:#243449;
  --border-strong:#2c3f57;
  --primary:#60a5fa;
  --danger:#f87171;
  --ring: rgba(96,165,250,.35);
  --shadow:0 10px 40px rgba(2,6,23,.35);
}

/* --- Layout --- */
*{box-sizing:border-box}
html,body{height:100%}
body.app-body{
  margin:0;
  font-family:Poppins, Montserrat, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--text);
  background:radial-gradient(1200px 600px at 20% -10%, rgba(59,130,246,.08), transparent 60%),
             radial-gradient(1000px 500px at 110% 10%, rgba(59,130,246,.08), transparent 55%),
             var(--bg);
  line-height:1.6;
  -webkit-font-smoothing:antialiased;
  text-rendering:optimizeLegibility;
}

.container{
  width:min(1100px, calc(100% - 32px));
  margin-inline:auto;
}

/* --- Header --- */
header{
  position:sticky; top:0; z-index:10;
  background:color-mix(in hsl, var(--bg) 94%, transparent);
  -webkit-backdrop-filter:saturate(1.3) blur(8px);
  backdrop-filter:saturate(1.3) blur(8px);
  border-bottom:1px solid var(--border);
}
header .container{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:10px 0;}
.brand{display:flex; align-items:center; gap:10px; font-weight:600; letter-spacing:.2px;}
.brand .dot{width:10px;height:10px;border-radius:999px;background:var(--primary);box-shadow:0 0 0 4px var(--ring)}
header .actions{display:flex; align-items:center; gap:10px;}

/* --- Controls & Panels --- */
main .container{display:grid; grid-template-columns: 360px 1fr; gap:16px; padding:16px 0;}
@media (max-width: 980px){ main .container{ grid-template-columns:1fr; } }

.panel{
  background:var(--bg-elev);
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px;
}
.panel h2{margin:0 0 8px; font-size:var(--fs-16)}
.panel .sub{margin:-2px 0 10px; color:var(--muted); font-size:var(--fs-12)}

fieldset{border:none; padding:0; margin:0 0 12px}
legend{font-weight:600; margin-bottom:8px; font-size:var(--fs-14)}
.row{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
.row-3{display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px}
@media (max-width: 520px){ .row, .row-3{ grid-template-columns:1fr; } }

label{font-size:12px; color:var(--muted); display:block; margin:6px 0 4px}
input[type="text"], input[type="number"], select, input[type="color"], input[type="range"]{
  width:100%; padding:9px 10px; border-radius:10px; background:var(--bg-elev);
  border:1px solid var(--border-strong); color:var(--text); font-size: var(--fs-14);
  outline:none; box-shadow:0 0 0 0 var(--ring); transition:box-shadow .2s,border-color .2s, background .2s;
}
input:focus, select:focus{ border-color: var(--primary); box-shadow:0 0 0 4px var(--ring); }

.range-inline{display:flex; align-items:center; gap:10px}
.range-inline input[type="range"]{flex:1}

.inline{display:flex; align-items:center; gap:8px}
.inline small{color:var(--muted)}

/* --- Dropzone --- */
.drop{
  display:flex; align-items:center; justify-content:center; text-align:center; gap:10px;
  padding:18px; border:1.5px dashed var(--border-strong); border-radius:14px;
  background:linear-gradient(180deg, color-mix(in hsl, var(--bg-elev) 92%, transparent), transparent);
  cursor:pointer; transition:border-color .2s, background .2s, transform .06s ease;
}
.drop:hover{ border-color:var(--primary); background:color-mix(in hsl, var(--bg-elev) 96%, transparent) }
.drop:active{ transform:translateY(1px) }
.drop small{color:var(--muted)}

/* --- Buttons --- */
.btns{display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:12px}
.btn{
  appearance:none; border:1px solid var(--border-strong); background:var(--bg-elev);
  padding:10px 14px; border-radius:12px; font-weight:600; letter-spacing:.1px;
  cursor:pointer; color:var(--text); transition:transform .06s ease, box-shadow .2s, border-color .2s, background .2s;
  box-shadow:0 1px 0 rgba(2,6,23,.04);
}
.btn:hover{ border-color:var(--primary); box-shadow:0 6px 18px rgba(2,6,23,.08) }
.btn:active{ transform:translateY(1px) }
.btn.primary{ background:var(--primary); color:#fff; border-color:transparent }
.btn.danger{ background:var(--danger); color:#fff; border-color:transparent }

/* --- Cards / Grid Preview --- */
.grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap:12px }
.card{
  background:var(--bg-elev); border:1px solid var(--border); border-radius:14px; padding:10px;
  box-shadow:var(--shadow); transition:box-shadow .2s, transform .06s;
}
.card:hover{ box-shadow:0 14px 34px rgba(2,6,23,.12) }
.card canvas{ width:100%; height:auto; border-radius:10px; background:#000 }
.card .meta{ display:flex; justify-content:space-between; align-items:center; margin-top:8px; font-size:12px; color:var(--muted) }
.card a{ display:inline-flex; align-items:center; gap:6px; padding:7px 9px; border:1px solid var(--border-strong); border-radius:10px; text-decoration:none; background:var(--bg-elev); color:var(--text) }

/* --- Footer --- */
footer{ border-top:1px solid var(--border); margin-top:20px; }
footer .container{ display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; gap:10px; padding:14px 0; }
footer p{ color:var(--muted); font-size:12px; margin:0 }
.theme-toggle{display:inline-flex; align-items:center; gap:8px}
/* Badge */
.badge{ font-size:11px; padding:2px 8px; border-radius:999px; border:1px solid var(--border-strong); color:var(--muted); background:var(--bg-elev) }

/* --- Tidy: consistent section spacing & headings --- */
h1,h2,h3{letter-spacing:.1px}
section{margin-top:18px}
.panel h2{font-weight:700}
.panel .sub{margin-top:-2px}

/* --- Inputs polish --- */
input[type="text"], input[type="number"], select, input[type="color"], input[type="range"]{
  height:42px;
}
select{appearance:none;background-image:linear-gradient(45deg,transparent 50%, var(--muted) 50%),linear-gradient(135deg,var(--muted) 50%, transparent 50%);background-position:calc(100% - 18px) 18px, calc(100% - 13px) 18px;background-size:5px 5px, 5px 5px;background-repeat:no-repeat}

/* Range */
input[type="range"]{height:auto; -webkit-appearance:none; background:transparent}
input[type="range"]::-webkit-slider-runnable-track{height:6px;border-radius:999px;background:linear-gradient(90deg,var(--primary),color-mix(in hsl,var(--primary) 60%, transparent))}
input[type="range"]::-moz-range-track{height:6px;border-radius:999px;background:linear-gradient(90deg,var(--primary),color-mix(in hsl,var(--primary) 60%, transparent))}
input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:#fff;border:2px solid var(--primary);margin-top:-6px;box-shadow:0 2px 6px rgba(2,6,23,.2)}
input[type="range"]::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:#fff;border:2px solid var(--primary);box-shadow:0 2px 6px rgba(2,6,23,.2)}

/* Dropzone tone */
.drop{background:linear-gradient(180deg, color-mix(in hsl, #eaf2ff 45%, var(--bg-elev) 55%), transparent)}

/* Buttons hover soften */
.btn:hover{border-color:color-mix(in hsl,var(--primary) 70%, var(--border-strong)); box-shadow:0 8px 20px rgba(2,6,23,.10)}

/* --- Header aesthetic tidy --- */
.header-bar{display:flex; align-items:flex-end; justify-content:space-between; gap:16px; padding:16px 0;}
.brand{display:grid; grid-template-columns:auto 1fr; align-items:center; gap:12px}
.brand h1{margin:0; font-size:28px; line-height:1.15; letter-spacing:.2px}
.subtitle{margin-top:2px; font-size:14px; color:var(--muted)}
.logo{width:36px; height:36px; border-radius:12px; display:grid; place-items:center; font-weight:700; letter-spacing:.8px; color:#fff;
  background: linear-gradient(135deg, var(--primary), color-mix(in hsl, var(--primary) 65%, #a5b4fc));
  box-shadow: 0 8px 18px rgba(2,6,23,.15);
}
.theme-toggle{border:1px solid var(--border-strong); background:var(--bg-elev); padding:8px 10px; border-radius:999px; font-weight:600}
@media (max-width:680px){
  .header-bar{flex-wrap:wrap; align-items:center}
  .brand{width:100%}
  .theme-toggle{margin-left:auto}
  .brand h1{font-size:24px}
  .subtitle{font-size:13px}
}

footer .container{
  justify-content:center !important;
  text-align:center;
}
footer p{
  width:100%;
  text-align:center;
  color:var(--muted);
  font-size:13px;
  margin:14px 0;
}

/* --- Header centered layout --- */
header .container{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:18px 0;
}
.brand{display:flex; align-items:center; justify-content:center; gap:10px}
.brand h1{font-size:28px; margin:0}
.subtitle{text-align:center; font-size:14px; color:var(--muted)}
.theme-toggle{margin-top:10px; padding:8px 14px; border-radius:999px; font-weight:600; transition:all .2s ease}
[data-theme="dark"] .theme-toggle{color:#fff; border-color:var(--border-strong)}
.theme-toggle:hover{border-color:var(--primary)}

/* --- Compact and mobile-first adjustments --- */
html, body{
  font-size:13px;
}
header .container{
  padding:12px 0;
}
.brand h1{
  font-size:22px;
}
.logo{
  width:28px; height:28px; border-radius:9px; font-size:12px;
}
.subtitle{
  font-size:12.5px;
}
.theme-toggle{
  font-size:12px; padding:6px 10px;
}
section{
  margin-top:14px;
}
label{
  font-size:11.5px;
}
input[type="text"], input[type="number"], select, input[type="color"], input[type="range"]{
  height:36px; font-size:12.5px;
}
.btn{
  padding:7px 10px; font-size:13px;
}
.grid{
  gap:8px;
}
.card{
  padding:6px;
}
footer p{
  font-size:12px;
}

/* mobile optimization */
@media (max-width:600px){
  body{font-size:12.5px;}
  .brand h1{font-size:20px;}
  .subtitle{font-size:12px;}
  input, select{font-size:12px;}
  .btn{font-size:12px;}
  section{margin-top:12px;}
}

/* --- v8: header left-right bar, stable on mobile --- */
header .container{
  display:flex;
  align-items:center;
  justify-content:space-between;
  text-align:left;
  padding:12px 0;
}
.header-bar{display:flex; align-items:center; justify-content:space-between; width:100%; gap:10px; flex-wrap:nowrap}
.brand{display:flex; align-items:center; gap:10px; min-width:0}
.brand h1{font-size:22px; margin:0; white-space:nowrap}
.subtitle{font-size:12px; margin-top:2px}
.brand > div{display:flex; flex-direction:column; min-width:0}
.theme-toggle{margin:0; font-size:12px; padding:6px 10px; white-space:nowrap; flex:0 0 auto}

/* Keep on one line for small screens */
@media (max-width: 480px){
  .brand h1{font-size:20px}
  .subtitle{font-size:11.5px}
  .theme-toggle{font-size:11.5px; padding:6px 10px}
}

/* Prevent wrapping of header children */
header .container, .header-bar{flex-wrap:nowrap}

.spinner{width:32px;height:32px;border-radius:50%;border:3px solid #ddd;border-top-color:#333;margin:16px auto;animation:sp 1s linear infinite}
@keyframes sp{to{transform:rotate(360deg)}}
.dragging{outline:2px dashed #999; outline-offset:6px}


/* --- FIX LAYOUT WATERMARK STORY --- */
.header-bar {
  flex-wrap: wrap;
  text-align: center;
  justify-content: center;
  gap: 6px;
}
.brand {
  flex-direction: column;
  align-items: center;
  text-align: center;
}
.brand h1 {
  font-size: 22px;
  white-space: normal;
}
.subtitle {
  font-size: 12px;
  white-space: normal;
}
.theme-toggle {
  margin-top: 6px;
  align-self: center;
}
#drop {
  max-width: 100%;
  word-wrap: break-word;
  overflow-wrap: break-word;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
}
#drop p {
  margin: 0;
  padding: 8px;
  font-size: 13px;
  color: var(--muted);
  line-height: 1.4;
}


/* --- FIX: Hide native file input so "No file chosen" doesn't spill out --- */
.drop { position: relative; }
.drop input[type="file"]{
  position: absolute;
  inset: 0 auto auto 0;
  width: 1px; height: 1px;
  opacity: 0;
  pointer-events: none; /* clickable via JS on .drop */
}
/* Instruction text stays centered and wrapped */
.drop p{
  max-width: 100%;
  margin: 0;
  padding: 8px;
  text-align: center;
  word-break: break-word;
  overflow-wrap: anywhere;
}

/* Header tidy (no logo) */
.brand{ flex-direction: column; align-items: center; text-align: center; }
.brand h1{ margin: 0; font-size: 22px; }
.subtitle{ font-size: 12.5px; }
.header-bar{ flex-wrap: wrap; justify-content: center; gap: 6px; }
.theme-toggle{ margin-top: 6px; }
